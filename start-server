#!/bin/bash

# Set proper file permissions
chmod -R 777 storage bootstrap/cache

# Generate application key if not set
if [ -z "$(grep -r 'APP_KEY=' .env | cut -d '=' -f2)" ]; then
    php artisan key:generate
fi

# Clear and cache config
php artisan config:clear
php artisan config:cache

# Clear and cache routes
php artisan route:clear
php artisan route:cache

# Clear and cache views
php artisan view:clear
php artisan view:cache

# Start the server
exec php artisan serve --host=0.0.0.0 --port=${PORT}
